# Классификация состояний покоя с открытыми и закрытыми глазами на основе fMRI данных

## Описание задания

Цель данного проекта — разработать модель машинного обучения (ML) или глубокого обучения (DL), способную классифицировать состояния покоя человека с открытыми и закрытыми глазами на основе данных функциональной магнитно-резонансной томографии (fMRI). Эти состояния характеризуются различиями в активности зрительной коры и связанных с ней структур мозга. Задача заключается в создании модели, которая может быть обучена на одном наборе данных (например, открытых данных) и применена к другому (например, клиническим данным конкретного учреждения).

### Данные

Для обучения и тестирования модели используются два набора данных:
1. **Beijing Normal University (BNU) dataset**: 
   - 47 участников с открытыми глазами, 95 участников с закрытыми глазами.
2. **Институт мозга человека РАН (IHB RAS) dataset**: 
   - 10 участников с открытыми глазами, 10 участников с закрытыми глазами (обучение).
   - 20 участников с открытыми глазами, 20 участников с закрытыми глазами (публичный тест).
   - 117 участников с открытыми глазами, 117 участников с закрытыми глазами (приватный тест).

Данные представлены в виде временных рядов fMRI, которые могут быть преобразованы в матрицы функциональной связности (functional connectivity matrices) с использованием коэффициента корреляции Пирсона.

## Решение

### Основные шаги решения:
1. **Предобработка данных**:
   - Использование oversampling для балансировки классов в наборе данных BNU.
   - Преобразование временных рядов fMRI в матрицы функциональной связности.
   - Разделение данных на обучающую и тестовую выборки.

2. **Обучение модели**:
   - Использование CatBoost для классификации с подбором гиперпараметров через GridSearch.
   - Отбор топ-40 наиболее важных признаков с помощью CatBoost feature importance.
   - Применение PCA для уменьшения размерности данных.

3. **Ансамбль моделей**:
   - Использование ансамбля из трех моделей: CatBoost, логистической регрессии и перцептрона для улучшения качества классификации.

4. **Тестирование и оценка**:
   - Оценка модели на тестовых данных с использованием метрик accuracy и F1-score.
   - Сохранение обученной модели в формате `.pkl` для дальнейшего использования.

### Результаты:
- **CatBoost**:
  - Accuracy на обучении: 0.968
  - Accuracy на тесте: 0.85
  - F1-score на тесте: 0.84211

- **Ансамбль моделей**:
  - Accuracy на обучении: 0.978 (CatBoost), 0.785 (логистическая регрессия), 1.0 (перцептрон).
  - Accuracy на тесте: 0.95
  - F1-score на тесте: 0.95238

### Достоинства решения:
- Высокая скорость обучения.
- Малый вес модели.
- Возможность улучшения качества при увеличении объема данных.

## Использование

1. **Обучение модели**:
   - Запустите `train.sh` для обучения модели на предоставленных данных.

2. **Тестирование модели**:
   - Запустите `run.sh` для применения модели к новым данным и получения предсказаний.

3. **Сохранение и загрузка модели**:
   - Модель сохраняется в файл `model.pkl` и может быть загружена для дальнейшего использования.

## Заключение

Данное решение демонстрирует эффективность использования CatBoost и ансамбля моделей для классификации состояний покоя с открытыми и закрытыми глазами на основе fMRI данных. Модель способна обобщать данные из разных источников и может быть использована в реальных клинических исследованиях.
